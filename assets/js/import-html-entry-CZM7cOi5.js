import{b as oe,c as z,d as ue,e as Q,f as I}from"./@babel-B8PJrZfF.js";function Z(e,t){return Promise.all(e.map(function(n,r){return n.then(function(a){return{status:"fulfilled",value:a}}).catch(function(a){if(t!=null&&t(r))throw a;return{status:"rejected",reason:a}})}))}var ie=typeof navigator<"u"&&navigator.userAgent.indexOf("Trident")!==-1;function ee(e,t){if(!e.hasOwnProperty(t)||!isNaN(t)&&t<e.length)return!0;if(ie)try{return e[t]&&typeof window<"u"&&e[t].parent===window}catch{return!0}else return!1}var O,S,L;function se(e){var t=0,n,r=!1;for(var a in e)if(!ee(e,a)){for(var c=0;c<window.frames.length&&!r;c++){var o=window.frames[c];if(o===e[a]){r=!0;break}}if(!r&&(t===0&&a!==O||t===1&&a!==S))return a;t++,n=a}if(n!==L)return n}function ce(e){O=S=void 0;for(var t in e)ee(e,t)||(O?S||(S=t):O=t,L=t);return L}function N(e){var t=e.indexOf(">")+1,n=e.lastIndexOf("<");return e.substring(t,n)}function A(e){if(oe(e)==="object")return"/";try{var t=new URL(e,location.href),n=t.origin,r=t.pathname,a=r.split("/");return a.pop(),"".concat(n).concat(a.join("/"),"/")}catch(c){return console.warn(c),""}}function le(){var e=document.createElement("script");return"noModule"in e}var fe=window.requestIdleCallback||function(t){var n=Date.now();return setTimeout(function(){t({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-n))}})},1)};function ve(e,t){if(!t||!e.headers)return e.text();var n=e.headers.get("Content-Type");if(!n)return e.text();var r="utf-8",a=n.split(";");if(a.length===2){var c=a[1].split("="),o=z(c,2),i=o[1],s=i&&i.trim();s&&(r=s)}return r.toUpperCase()==="UTF-8"?e.text():e.blob().then(function(u){return new Promise(function(v,d){var m=new window.FileReader;m.onload=function(){v(m.result)},m.onerror=d,m.readAsText(u,r)})})}var X={};function de(e,t){var n=e;if(!X[n]){var r="(function(){".concat(t,"})");X[n]=(0,eval)(r)}var a=X[n];a.call(window)}function F(e){var t=new DOMParser,n='<script src="'.concat(e,'"><\/script>'),r=t.parseFromString(n,"text/html");return r.scripts[0].src}var he=/(<script[\s\S]*?>)[\s\S]*?<\/script>/gi,pe=/<(script)\s+((?!type=('|")text\/ng\x2Dtemplate\3)[\s\S])*?>[\s\S]*?<\/\1>/i,Y=/.*\ssrc=('|")?([^>'"\s]+)/,ge=/.*\stype=('|")?([^>'"\s]+)/,me=/.*\sentry\s*.*/,ye=/.*\sasync\s*.*/,we=/.*\scrossorigin=('|")?use-credentials\1/,Ee=/.*\snomodule\s*.*/,be=/.*\stype=('|")?module('|")?\s*.*/,Pe=/<(link)\s+[\s\S]*?>/ig,Re=/\srel=('|")?(preload|prefetch)\1/,$=/.*\shref=('|")?([^>'"\s]+)/,_e=/.*\sas=('|")?font\1.*/,xe=/<style[^>]*>[\s\S]*?<\/style>/gi,Te=/\s+rel=('|")?stylesheet\1.*/,Ge=/.*\shref=('|")?([^>'"\s]+)/,Oe=/<!--([\s\S]*?)-->/g,Se=/<link(\s+|\s+[\s\S]+\s+)ignore(\s*|\s+[\s\S]*|=[\s\S]*)>/i,Ie=/<style(\s+|\s+[\s\S]+\s+)ignore(\s*|\s+[\s\S]*|=[\s\S]*)>/i,Ce=/<script(\s+|\s+[\s\S]+\s+)ignore(\s*|\s+[\s\S]*|=[\s\S]*)>/i;function V(e){return e.startsWith("http://")||e.startsWith("https://")}function W(e,t){return new URL(e,t).toString()}function je(e){var t=["text/javascript","module","application/javascript","text/ecmascript","application/ecmascript"];return!e||t.indexOf(e)!==-1}var C=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return"<!-- ".concat(n?"prefetch/preload":""," link ").concat(t," replaced by import-html-entry -->")},te=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return"<!-- ".concat(r?"cors":""," ").concat(n?"async":""," script ").concat(t," replaced by import-html-entry -->")},Xe="<!-- inline scripts replaced by import-html-entry -->",G=function(t){return"<!-- ignore asset ".concat(t||"file"," replaced by import-html-entry -->")},K=function(t,n){return"<!-- ".concat(n?"nomodule":"module"," script ").concat(t," ignored by import-html-entry -->")};function Le(e,t,n){var r=[],a=[],c=null,o=le(),i=e.replace(Oe,"").replace(Pe,function(u){var v=!!u.match(Te);if(v){var d=u.match(Ge),m=u.match(Se);if(d){var f=d&&d[2],y=f;return f&&!V(f)&&(y=W(f,t)),m?G(y):(y=F(y),a.push(y),C(y))}}var w=u.match(Re)&&u.match($)&&!u.match(_e);if(w){var E=u.match($),l=z(E,3),g=l[2];return C(g,!0)}return u}).replace(xe,function(u){return Ie.test(u)?G("style file"):u}).replace(he,function(u,v){var d=v.match(Ce),m=o&&!!v.match(Ee)||!o&&!!v.match(be),f=v.match(ge),y=f&&f[2];if(!je(y))return u;if(pe.test(u)&&v.match(Y)){var w=v.match(me),E=v.match(Y),l=E&&E[2];if(c&&w)throw new SyntaxError("You should not set multiply entry script!");if(l&&(V(l)||(l=W(l,t)),l=F(l)),c=c||w&&l,d)return G(l||"js file");if(m)return K(l||"js file",o);if(l){var g=!!v.match(ye),b=!!v.match(we);return r.push(g||b?{async:g,src:l,crossOrigin:b}:l),te(l,g,b)}return u}else{if(d)return G("js file");if(m)return K("js file",o);var x=N(u),p=x.split(/[\r\n]+/).every(function(h){return!h.trim()||h.trim().startsWith("//")});return p||r.push(u),Xe}});r=r.filter(function(u){return!!u});var s={template:i,scripts:r,styles:a,entry:c||r[r.length-1]};return typeof n=="function"&&(s=n(s)),s}function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?H(Object(n),!0).forEach(function(r){ue(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var q={},B={},U={};if(!window.fetch)throw new Error('[import-html-entry] Here is no "fetch" on the window env, you need to polyfill it');var _=window.fetch.bind(window);function M(e){return e}function ne(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=n.fetch,a=r===void 0?_:r,c=e;return D(t,a).then(function(o){return c=o.reduce(function(i,s){var u=s.src,v=s.value;return i=i.replace(C(u),j(u)?"".concat(u):"<style>/* ".concat(u," */").concat(v,"</style>")),i},c),c})}var j=function(t){return t.startsWith("<")};function Ae(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=n.proxy,a=n.strictGlobal,c=n.scopedGlobalVariables,o=c===void 0?[]:c,i=j(e)?"":"//# sourceURL=".concat(e,`
`),s=o.length?"const {".concat(o.join(","),"}=this;"):"",u=(0,eval)("window");return u.proxy=r,a?s?";(function(){with(this){".concat(s).concat(t,`
`).concat(i,"}}).bind(window.proxy)();"):";(function(window, self, globalThis){with(window){;".concat(t,`
`).concat(i,"}}).bind(window.proxy)(window.proxy, window.proxy, window.proxy);"):";(function(window, self, globalThis){;".concat(t,`
`).concat(i,"}).bind(window.proxy)(window.proxy, window.proxy, window.proxy);")}function D(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_;return Z(e.map(function(){var n=Q(I.mark(function r(a){return I.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!j(a)){o.next=4;break}return o.abrupt("return",N(a));case 4:return o.abrupt("return",q[a]||(q[a]=t(a).then(function(i){if(i.status>=400)throw new Error("".concat(a," load failed with status ").concat(i.status));return i.text()}).catch(function(i){try{i.message.indexOf(a)===-1&&(i.message="".concat(a," ").concat(i.message))}catch{}throw i})));case 5:case"end":return o.stop()}},r)}));return function(r){return n.apply(this,arguments)}}())).then(function(n){return n.map(function(r,a){return r.status==="fulfilled"&&(r.value={src:e[a],value:r.value}),r}).filter(function(r){return r.status==="rejected"&&Promise.reject(r.reason),r.status==="fulfilled"}).map(function(r){return r.value})})}function k(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_,n=arguments.length>2?arguments[2]:void 0,r=function(o,i){return B[o]||(B[o]=t(o,i).then(function(s){if(s.status>=400)throw new Error("".concat(o," load failed with status ").concat(s.status));return s.text()}).catch(function(s){try{s.message.indexOf(o)===-1&&(s.message="".concat(o," ").concat(s.message))}catch{}throw s}))},a=function(o){return e[o]===n};return Z(e.map(function(){var c=Q(I.mark(function o(i){var s,u,v,d;return I.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(typeof i!="string"){f.next=8;break}if(!j(i)){f.next=5;break}return f.abrupt("return",N(i));case 5:return f.abrupt("return",r(i));case 6:f.next=13;break;case 8:if(s=i.src,u=i.async,v=i.crossOrigin,d=v?{credentials:"include"}:{},!u){f.next=12;break}return f.abrupt("return",{src:s,async:!0,content:new Promise(function(y,w){return fe(function(){return r(s,d).then(y,w)})})});case 12:return f.abrupt("return",r(s,d));case 13:case"end":return f.stop()}},o)}));return function(o){return c.apply(this,arguments)}}()),a).then(function(c){return c.map(function(o,i){return o.status==="fulfilled"&&(o.value={src:e[i],value:o.value}),o}).filter(function(o){return o.status==="rejected"&&Promise.reject(o.reason),o.status==="fulfilled"}).map(function(o){return o.value})})}function J(e,t){setTimeout(function(){throw console.error(t),e})}function ae(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=r.fetch,c=a===void 0?_:a,o=r.strictGlobal,i=o===void 0?!1:o,s=r.success,u=r.error,v=u===void 0?function(){}:u,d=r.beforeExec,m=d===void 0?function(){}:d,f=r.afterExec,y=f===void 0?function(){}:f,w=r.scopedGlobalVariables,E=w===void 0?[]:w;return k(t,c,e).then(function(l){var g=function(h,R){var T=m(R,h)||R,P=Ae(h,T,{proxy:n,strictGlobal:i,scopedGlobalVariables:E});de(h,P),y(R,h)};function b(p,h,R){if(p===e){ce(i?n:window);try{g(p,h);var T=n[se(i?n:window)]||{};R(T)}catch(P){throw console.error("[import-html-entry]: error occurs while executing entry script ".concat(p)),P}}else if(typeof h=="string")try{p!=null&&p.src?g(p.src,h):g(p,h)}catch(P){J(P,"[import-html-entry]: error occurs while executing normal script ".concat(p))}else h.async&&h?.content.then(function(P){return g(h.src,P)}).catch(function(P){J(P,"[import-html-entry]: error occurs while executing async script ".concat(h.src))})}function x(p,h){if(p<l.length){var R=l[p],T=R.src,P=R.value;b(T,P,h),!e&&p===l.length-1?h():x(p+1,h)}}return new Promise(function(p){return x(0,s||p)})}).catch(function(l){throw v(),l})}function Me(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=_,r=!1,a=A,c=M,o=t.postProcessTemplate;return typeof t=="function"?n=t:(t.fetch&&(typeof t.fetch=="function"?n=t.fetch:(n=t.fetch.fn||_,r=!!t.fetch.autoDecodeResponse)),a=t.getPublicPath||t.getDomain||A,c=t.getTemplate||M),U[e]||(U[e]=n(e).then(function(i){return ve(i,r)}).then(function(i){var s=a(e),u=Le(c(i),s,o),v=u.template,d=u.scripts,m=u.entry,f=u.styles;return ne(v,f,{fetch:n}).then(function(y){return{template:y,assetPublicPath:s,getExternalScripts:function(){return k(d,n)},getExternalStyleSheets:function(){return D(f,n)},execScripts:function(E,l){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return d.length?ae(m,d,E,re({fetch:n,strictGlobal:l},g)):Promise.resolve()}}})}))}function De(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.fetch,r=n===void 0?_:n,a=t.getTemplate,c=a===void 0?M:a,o=t.postProcessTemplate,i=t.getPublicPath||t.getDomain||A;if(!e)throw new SyntaxError("entry should not be empty!");if(typeof e=="string")return Me(e,{fetch:r,getPublicPath:i,getTemplate:c,postProcessTemplate:o});if(Array.isArray(e.scripts)||Array.isArray(e.styles)){var s=e.scripts,u=s===void 0?[]:s,v=e.styles,d=v===void 0?[]:v,m=e.html,f=m===void 0?"":m,y=function(l){return d.reduceRight(function(g,b){return"".concat(C(b)).concat(g)},l)},w=function(l){return u.reduce(function(g,b){return"".concat(g).concat(te(b))},l)};return ne(c(w(y(f))),d,{fetch:r}).then(function(E){return{template:E,assetPublicPath:i(e),getExternalScripts:function(){return k(u,r)},getExternalStyleSheets:function(){return D(d,r)},execScripts:function(g,b){var x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return u.length?ae(u[u.length-1],u,g,re({fetch:r,strictGlobal:b},x)):Promise.resolve()}}})}else throw new SyntaxError("entry scripts or styles should be array!")}export{ae as _,De as i};
